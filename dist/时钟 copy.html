<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>macOS Clock Pro</title>
    <style>
        :root {
            --mac-bg-gradient: linear-gradient(135deg, #e5e5e7 0%, #ffffff 100%);
            --glass-bg: rgba(255, 255, 255, 0.6);
            --glass-border: rgba(255, 255, 255, 0.8);
            --text-main: #1d1d1f;
            --text-sub: #86868b;
            --mac-accent: #007AFF;
            --mac-danger: #FF3B30;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            background: var(--mac-bg-gradient);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-main);
            overflow: hidden;
            transition: background 0.5s;
        }

        /* 窗口容器 */
        .window {
            width: 550px;
            background: var(--glass-bg);
            backdrop-filter: blur(30px) saturate(180%);
            -webkit-backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.12);
            overflow: hidden;
            position: relative;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s;
        }

        /* 最小化状态 */
        .window.minimized {
            transform: scale(0) translateY(500px);
            opacity: 0;
            pointer-events: none;
        }

        /* 恢复按钮 */
        #restore-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--mac-accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            display: none;
            box-shadow: 0 4px 15px rgba(0,122,255,0.3);
        }

        /* 顶部栏按钮增强 */
        .title-bar {
            height: 50px;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            padding: 0 20px;
            gap: 10px;
        }

        .dot { 
            width: 14px; height: 14px; border-radius: 50%; 
            cursor: pointer; position: relative; border: none;
        }
        .dot::after {
            content: ''; font-size: 8px; font-weight: bold; position: absolute;
            top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0;
        }
        .title-bar:hover .dot::after { opacity: 0.6; }
        
        .red { background: #FF5F56; } .red::after { content: '×'; }
        .yellow { background: #FFBD2E; } .yellow::after { content: '−'; }
        .green { background: #27C93F; } .green::after { content: '⤢'; }

        /* 内容与显示 */
        .tabs { display: flex; justify-content: center; gap: 30px; padding: 15px 0; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .tab-btn { background: none; border: none; color: var(--text-sub); cursor: pointer; font-size: 18px; font-weight: 500; padding: 8px 15px; border-radius: 8px; transition: 0.2s; }
        .tab-btn.active { color: var(--mac-accent); background: rgba(0, 122, 255, 0.1); }

        .content { padding: 50px 40px; text-align: center; min-height: 280px; }
        .display { font-size: 82px; font-weight: 200; margin-bottom: 30px; letter-spacing: -2px; font-variant-numeric: tabular-nums; }
        .date-display { font-size: 20px; color: var(--text-sub); margin-bottom: 10px; }

        .controls { display: flex; justify-content: center; gap: 20px; }
        button.action-btn { background: white; border: 1px solid rgba(0,0,0,0.1); color: var(--text-main); padding: 12px 35px; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.2s; }
        button.primary { background: var(--mac-accent); color: white; border: none; }
        
        .timer-inputs { margin-bottom: 30px; }
        input[type="number"] { background: white; border: 1px solid rgba(0,0,0,0.1); width: 80px; padding: 10px; border-radius: 10px; text-align: center; font-size: 24px; outline: none; }
        
        .hidden { display: none; }
        .ms { font-size: 40px; color: var(--text-sub); }
    </style>
</head>
<body>

<div class="window" id="main-window">
    <div class="title-bar">
        <button class="dot red" onclick="closeWindow()" title="关闭"></button>
        <button class="dot yellow" onclick="minimizeWindow()" title="最小化"></button>
        <button class="dot green" onclick="toggleFullScreen()" title="全屏"></button>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="showTab('clock')">时钟</button>
        <button class="tab-btn" onclick="showTab('stopwatch')">秒表</button>
        <button class="tab-btn" onclick="showTab('timer')">计时器</button>
    </div>

    <div id="clock-section" class="content">
        <div id="current-date" class="date-display"></div>
        <div class="display" id="clock-display">00:00:00</div>
    </div>

    <div id="stopwatch-section" class="content hidden">
        <div class="display" id="stopwatch-main">00:00<span class="ms">.00</span></div>
        <div class="controls">
            <button class="action-btn primary" id="sw-start" onclick="toggleStopwatch()">开始</button>
            <button class="action-btn" onclick="resetStopwatch()">重置</button>
        </div>
    </div>

    <div id="timer-section" class="content hidden">
        <div id="timer-input-group" class="timer-inputs">
            <input type="number" id="timer-min" placeholder="00"> : <input type="number" id="timer-sec" placeholder="00">
        </div>
        <div class="display hidden" id="timer-display">00:00</div>
        <div class="controls">
            <button class="action-btn primary" id="tm-start" onclick="toggleTimer()">开始</button>
            <button class="action-btn" onclick="resetTimer()">取消</button>
        </div>
    </div>
</div>

<button id="restore-btn" onclick="restoreWindow()">恢复时钟</button>

<script>
    const win = document.getElementById('main-window');
    const restoreBtn = document.getElementById('restore-btn');

    // --- 窗口控制功能 ---
    function toggleFullScreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen().catch(err => {
                alert(`无法进入全屏: ${err.message}`);
            });
        } else {
            document.exitFullscreen();
        }
    }

    function minimizeWindow() {
        win.classList.add('minimized');
        setTimeout(() => { restoreBtn.style.display = 'block'; }, 300);
    }

    function restoreWindow() {
        win.classList.remove('minimized');
        restoreBtn.style.display = 'none';
    }

    function closeWindow() {
        if(confirm("确定要关闭时钟吗？")) {
            win.style.opacity = '0';
            setTimeout(() => win.innerHTML = '<p style="padding:20px; color:#888">窗口已关闭</p>', 300);
        }
    }

    // --- 基础逻辑 (同上版本) ---
    function showTab(tab) {
        document.querySelectorAll('.content').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById(`${tab}-section`).classList.remove('hidden');
        event.currentTarget.classList.add('active');
    }

    function updateClock() {
        const now = new Date();
        document.getElementById('clock-display').textContent = now.toLocaleTimeString('zh-CN', { hour12: false });
        document.getElementById('current-date').textContent = now.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });
    }
    setInterval(updateClock, 1000); updateClock();

    let swInterval, swRunning = false, swTime = 0;
    function toggleStopwatch() {
        const btn = document.getElementById('sw-start');
        if (!swRunning) {
            swRunning = true; btn.textContent = '停止'; btn.style.background = 'var(--mac-danger)';
            const startTime = Date.now() - swTime;
            swInterval = setInterval(() => {
                swTime = Date.now() - startTime;
                const ms = Math.floor((swTime % 1000) / 10), sec = Math.floor((swTime / 1000) % 60), min = Math.floor(swTime / 60000);
                document.getElementById('stopwatch-main').innerHTML = `${String(min).padStart(2, '0')}:${String(sec).padStart(2, '0')}<span class="ms">.${String(ms).padStart(2, '0')}</span>`;
            }, 10);
        } else {
            swRunning = false; btn.textContent = '开始'; btn.style.background = 'var(--mac-accent)'; clearInterval(swInterval);
        }
    }
    function resetStopwatch() {
        clearInterval(swInterval); swRunning = false; swTime = 0;
        document.getElementById('stopwatch-main').innerHTML = `00:00<span class="ms">.00</span>`;
        const btn = document.getElementById('sw-start'); btn.textContent = '开始'; btn.style.background = 'var(--mac-accent)';
    }

    let tmInterval, tmRunning = false, tmTotalSeconds = 0;
    function toggleTimer() {
        const btn = document.getElementById('tm-start'), inputGrp = document.getElementById('timer-input-group'), display = document.getElementById('timer-display');
        if (!tmRunning) {
            if (tmTotalSeconds <= 0) {
                tmTotalSeconds = (parseInt(document.getElementById('timer-min').value) || 0) * 60 + (parseInt(document.getElementById('timer-sec').value) || 0);
            }
            if (tmTotalSeconds <= 0) return;
            tmRunning = true; btn.textContent = '暂停'; inputGrp.classList.add('hidden'); display.classList.remove('hidden');
            tmInterval = setInterval(() => {
                tmTotalSeconds--;
                display.textContent = `${String(Math.floor(tmTotalSeconds / 60)).padStart(2, '0')}:${String(tmTotalSeconds % 60).padStart(2, '0')}`;
                if (tmTotalSeconds <= 0) { clearInterval(tmInterval); alert("时间到！"); resetTimer(); }
            }, 1000);
        } else {
            tmRunning = false; btn.textContent = '继续'; clearInterval(tmInterval);
        }
    }
    function resetTimer() {
        clearInterval(tmInterval); tmRunning = false; tmTotalSeconds = 0;
        document.getElementById('tm-start').textContent = '开始';
        document.getElementById('timer-input-group').classList.remove('hidden');
        document.getElementById('timer-display').classList.add('hidden');
    }
</script>

</body>
</html>